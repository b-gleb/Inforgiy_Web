import{u as x,r as i,f as A,j as a,m as b,a as B}from"./index-D3CFBGQq.js";function T({mode:r,branch:s,initDataUnsafe:c,date:u,timeRange:m,onClose:t,setRotaData:w,handleUpdateCell:f}){const n=x(),[d,g]=i.useState([]),[h,o]=i.useState([]),[l,k]=i.useState("");return i.useEffect(()=>(window.Telegram.WebApp.BackButton.onClick(t),window.Telegram.WebApp.BackButton.show(),()=>{window.Telegram.WebApp.BackButton.offClick(t),window.Telegram.WebApp.BackButton.hide()}),[t]),i.useEffect(()=>{A(s,c).then(e=>{g(e),o(e)}).catch(()=>{})},[s,c]),i.useEffect(()=>{const e=d.filter(p=>p.nick.toLowerCase().includes(l.toLowerCase()));o(e)},[l,d]),a.jsxs("div",{className:"popup",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("input",{type:"text",placeholder:"Поиск...",value:l,onChange:e=>k(e.target.value),className:"input-field mr-2"}),a.jsx("button",{onClick:()=>t(),className:"p-2 text-[#007aff] text-xl",children:"✕"})]}),r==="user_management"&&a.jsx("button",{className:"button-primary",onClick:()=>{window.Telegram.WebApp.HapticFeedback.impactOccurred("medium"),n("./profile",{state:{branch:s,editingUser:{id:null,username:"@",color:0},initDataUnsafe:c}})},children:"+ Добавить пользователя"}),a.jsx("div",{className:"search_results_container",children:h.map(e=>a.jsx(b.button,{initial:{opacity:.5,scale:.9},animate:{opacity:1,scale:1,transition:{ease:"easeOut",duration:.2}},onClick:()=>{r==="rota"?(B({type:"add",branch:s,date:u,timeRange:m,userId:e.id,initDataUnsafe:c}).then(p=>{w(p)}).catch(()=>{}),window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),t()):r==="user_management"?(window.Telegram.WebApp.BackButton.offClick(t),window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),n("./profile",{state:{branch:s,editingUser:e,initDataUnsafe:c}})):r==="rota_weekly"&&f({type:"add",branch:s,userId:e.id,initDataUnsafe:c}).then(()=>{window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),t()}).catch(()=>{})},className:"search_results_button",children:e.nick},e.id))})]})}export{T as default};
