const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/userProfile-BTuS4tnL.js","assets/index-Bo4-0vWi.js","assets/index-CNy_Jku-.css","assets/userEditForm-Bh8PJDRI.js"])))=>i.map(i=>d[i]);
import{r as t,j as e,m as y,u as A,_ as m}from"./index-Bo4-0vWi.js";import{f as b}from"./fetchAllUsers-CgEL_J9V.js";const E=t.lazy(()=>m(()=>import("./userProfile-BTuS4tnL.js"),__vite__mapDeps([0,1,2,3]))),T=t.lazy(()=>m(()=>import("./userEditForm-Bh8PJDRI.js"),__vite__mapDeps([3,1,2])));function W({mode:n,branch:c,initDataUnsafe:r,date:f,timeRange:h,onClose:a,setRotaData:w,handleUpdateCell:x}){const[p,k]=t.useState([]),[_,u]=t.useState([]),[d,g]=t.useState(""),[i,o]=t.useState(null);return t.useEffect(()=>(window.Telegram.WebApp.BackButton.onClick(a),window.Telegram.WebApp.BackButton.show(),()=>{window.Telegram.WebApp.BackButton.offClick(a),window.Telegram.WebApp.BackButton.hide()}),[a]),t.useEffect(()=>{(()=>{b(c,r).then(l=>{k(l),u(l)}).catch(()=>{})})()},[c,r]),t.useEffect(()=>{const s=p.filter(l=>l.nick.toLowerCase().includes(d.toLowerCase()));u(s)},[d,p]),e.jsx("div",{className:"popup",children:i?(i==null?void 0:i.id)!==null?e.jsx(t.Suspense,{fallback:null,children:e.jsx(E,{branch:c,editingUser:i,setEditingUser:o,initDataUnsafe:r})}):e.jsx(t.Suspense,{fallback:null,children:e.jsx(T,{branch:c,editingUser:i,setEditingUser:o,initDataUnsafe:r})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("input",{type:"text",placeholder:"Поиск...",value:d,onChange:s=>g(s.target.value),className:"input-field mr-2"}),e.jsx("button",{onClick:()=>a(),className:"p-2 text-[#007aff] text-xl",children:"✕"})]}),n==="user_management"&&e.jsx("button",{className:"button-primary",onClick:()=>{o({id:null,username:"@",color:0}),window.Telegram.WebApp.HapticFeedback.impactOccurred("medium")},children:"+ Добавить пользователя"}),e.jsx("div",{className:"search_results_container",children:_.map(s=>e.jsx(y.button,{initial:{opacity:.5,scale:.9},animate:{opacity:1,scale:1,transition:{ease:"easeOut",duration:.2}},onClick:()=>{n==="rota"?(A({type:"add",branch:c,date:f,timeRange:h,modifyUserId:s.id,initDataUnsafe:r}).then(l=>{w(l)}).catch(()=>{}),window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),a()):n==="user_management"?(window.Telegram.WebApp.BackButton.offClick(a),o(s),window.Telegram.WebApp.HapticFeedback.impactOccurred("light")):n==="rota_weekly"&&x({type:"add",branch:c,modifyUserId:s.id,initDataUnsafe:r}).then(()=>{window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),a()}).catch(()=>{})},className:"search_results_button",children:s.nick},s.id))})]})})}export{W as default};
