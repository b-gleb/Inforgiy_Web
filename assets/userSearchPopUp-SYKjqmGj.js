import{u as B,r as i,f as A,j as t,I as v,B as u,m as T,a as W}from"./index-DZ79j9Wk.js";function y({mode:r,branch:s,initDataUnsafe:c,date:m,timeRange:w,onClose:a,setRotaData:f,handleUpdateCell:g}){const p=B(),[n,h]=i.useState([]),[k,o]=i.useState([]),[l,x]=i.useState("");return i.useEffect(()=>(window.Telegram.WebApp.BackButton.onClick(a),window.Telegram.WebApp.BackButton.show(),()=>{window.Telegram.WebApp.BackButton.offClick(a),window.Telegram.WebApp.BackButton.hide()}),[a]),i.useEffect(()=>{A(s,c).then(e=>{h(e),o(e)}).catch(()=>{})},[s,c]),i.useEffect(()=>{const e=n.filter(d=>d.nick.toLowerCase().includes(l.toLowerCase()));o(e)},[l,n]),t.jsxs("div",{className:"popup",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(v,{type:"text",placeholder:"Поиск...",value:l,onChange:e=>x(e.target.value),className:"mr-2"}),t.jsx("button",{onClick:()=>a(),className:"p-2 text-[#007aff] text-xl",children:"✕"})]}),r==="user_management"&&t.jsx(u,{size:"lg",className:"w-full font-semibold mb-2",onClick:()=>{window.Telegram.WebApp.HapticFeedback.impactOccurred("medium"),p("./profile",{state:{branch:s,editingUser:{id:null,username:"@",color:0},initDataUnsafe:c}})},children:"+ Добавить пользователя"}),t.jsx("div",{className:"search_results_container",children:k.map(e=>t.jsx(T.div,{initial:{opacity:.5,scale:.7},animate:{opacity:1,scale:1,transition:{ease:"easeOut",duration:.2}},children:t.jsx(u,{variant:"outline",className:"w-full dark:text-white",onClick:()=>{r==="rota"?(W({type:"add",branch:s,date:m,timeRange:w,userId:e.id,initDataUnsafe:c}).then(d=>{f(d)}).catch(()=>{}),window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),a()):r==="user_management"?(window.Telegram.WebApp.BackButton.offClick(a),window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),p("./profile",{state:{branch:s,editingUser:e,initDataUnsafe:c}})):r==="rota_weekly"&&g({type:"add",branch:s,userId:e.id,initDataUnsafe:c}).then(()=>{window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),a()}).catch(()=>{})},children:e.nick})},e.id))})]})}export{y as default};
