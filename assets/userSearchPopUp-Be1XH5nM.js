import{u as x,r as i,f as y,j as a,m as A,a as b}from"./index-X5kranFW.js";function T({mode:r,branch:s,initDataUnsafe:c,date:u,timeRange:m,onClose:t,setRotaData:f,handleUpdateCell:w}){const d=x(),[n,g]=i.useState([]),[h,o]=i.useState([]),[l,k]=i.useState("");return i.useEffect(()=>(window.Telegram.WebApp.BackButton.onClick(t),window.Telegram.WebApp.BackButton.show(),()=>{window.Telegram.WebApp.BackButton.offClick(t),window.Telegram.WebApp.BackButton.hide()}),[t]),i.useEffect(()=>{y(s,c).then(e=>{g(e),o(e)}).catch(()=>{})},[s,c]),i.useEffect(()=>{const e=n.filter(p=>p.nick.toLowerCase().includes(l.toLowerCase()));o(e)},[l,n]),a.jsxs("div",{className:"popup",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("input",{type:"text",placeholder:"Поиск...",value:l,onChange:e=>k(e.target.value),className:"input-field mr-2"}),a.jsx("button",{onClick:()=>t(),className:"p-2 text-[#007aff] text-xl",children:"✕"})]}),r==="user_management"&&a.jsx("button",{className:"button-primary",onClick:()=>{window.Telegram.WebApp.HapticFeedback.impactOccurred("medium"),d("./profile",{state:{branch:s,editingUser:{id:null,username:"@",color:0},initDataUnsafe:c}})},children:"+ Добавить пользователя"}),a.jsx("div",{className:"search_results_container",children:h.map(e=>a.jsx(A.button,{initial:{opacity:.5,scale:.9},animate:{opacity:1,scale:1,transition:{ease:"easeOut",duration:.2}},onClick:()=>{r==="rota"?(b({type:"add",branch:s,date:u,timeRange:m,modifyUserId:e.id,initDataUnsafe:c}).then(p=>{f(p)}).catch(()=>{}),window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),t()):r==="user_management"?(window.Telegram.WebApp.BackButton.offClick(t),window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),d("./profile",{state:{branch:s,editingUser:e,initDataUnsafe:c}})):r==="rota_weekly"&&w({type:"add",branch:s,modifyUserId:e.id,initDataUnsafe:c}).then(()=>{window.Telegram.WebApp.HapticFeedback.impactOccurred("light"),t()}).catch(()=>{})},className:"search_results_button",children:e.nick},e.id))})]})}export{T as default};
