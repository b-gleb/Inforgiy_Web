import{r as b,j as n,a as v,f as a,b as w}from"./index-DKfdfCwq.js";const j="https://inforgiy-server.fly.dev";function Y({branch:d,user_id:u}){const[e,l]=b.useState(null);return b.useEffect(()=>{const r=new Date,o=t=>{const s=new Date(t);s.setDate(t.getDate()-(t.getDay()===0?6:t.getDay()-1));const c=new Date(s);return c.setDate(s.getDate()+6),[s,c]},y=t=>{const s=new Date(t.getFullYear(),t.getMonth(),1),c=new Date(t.getFullYear(),t.getMonth()+1,0);return[s,c]},f=t=>{const s=new Date(t.getFullYear(),0,1),c=new Date(t.getFullYear(),11,31);return[s,c]},i=o(r),x=o(new Date(r.getTime()-7*24*60*60*1e3)),h=y(r),M=y(new Date(r.getFullYear(),r.getMonth()-1,r.getDate())),m=f(r);(async()=>{try{const t=await v.post(`${j}/api/stats`,{branch:d,user_ids:[u],dateRanges:[[a(i[0],"yyyy-MM-dd"),a(i[1],"yyyy-MM-dd")],[a(x[0],"yyyy-MM-dd"),a(x[1],"yyyy-MM-dd")],[a(h[0],"yyyy-MM-dd"),a(h[1],"yyyy-MM-dd")],[a(M[0],"yyyy-MM-dd"),a(M[1],"yyyy-MM-dd")],[a(m[0],"yyyy-MM-dd"),a(m[1],"yyyy-MM-dd")]]}),s=Object.values(t.data)[0];l({currentWeek:s[0].count,previousWeek:s[1].count,currentMonth:s[2].count,previousMonth:s[3].count,currentYear:s[4].count})}catch(t){w(t)}})()},[d,u]),n.jsxs("div",{className:"flex flex-wrap justify-evenly py-2 bg-gray-100 dark:bg-neutral-900",children:[n.jsx(g,{label:"Неделя",sublabel:"от прошлой",current:(e==null?void 0:e.currentWeek)??null,previous:(e==null?void 0:e.previousWeek)??null}),n.jsx(g,{label:"Месяц",sublabel:"от прошлого",current:(e==null?void 0:e.currentMonth)??null,previous:(e==null?void 0:e.previousMonth)??null}),n.jsx(g,{label:"Год",sublabel:"от прошлого",current:(e==null?void 0:e.currentYear)??null,previous:(e==null?void 0:e.previousYear)??null})]})}const g=({label:d,sublabel:u,current:e,previous:l})=>{const r=l!=null,o=r&&e>l,y=r?e-l:0;return n.jsxs("div",{className:"rounded-2xl shadow-md p-2 w-1/4 bg-white dark:bg-neutral-800",children:[n.jsx("h3",{className:"text-base font-semibold mb-2 text-gray-500 dark:text-gray-400",children:d}),e===null?n.jsxs("div",{className:"animate-pulse",children:[n.jsx("div",{className:"h-10 rounded-sm w-3/4 mb-2 bg-gray-200 dark:bg-neutral-700"}),n.jsx("div",{className:"h-4 rounded-sm w-1/2 bg-gray-200 dark:bg-neutral-700"})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"text-2xl font-semibold mb-2 text-gray-800 dark:text-white",children:e}),r&&n.jsxs("div",{className:"flex items-center",children:[n.jsxs("span",{className:`text-[0.6rem] ${o?"text-green-500 dark:text-green-400":"text-red-500 dark:text-red-400"}`,children:[o?"↑":"↓"," ",Math.abs(y)]}),n.jsx("span",{className:"text-[0.6rem] ml-1 text-gray-500 dark:text-gray-400",children:u})]})]})]})};export{Y as default};
